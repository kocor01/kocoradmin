<!-- bootstrap3-wysihtml5 -->
<link rel="stylesheet" href="__STATIC__/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css">
<!-- fileinput -->
<link rel="stylesheet" href="__STATIC__/libs/bootstrap-fileinput/css/fileinput.min.css">

<form id="edit-form" class="form-horizontal" role="form" data-toggle="validator" method="POST" action="">

    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">父级：</label>
        <div class="col-xs-12 col-sm-8">
            <select class="form-control" name="row[cate_id]" data-rule="required">
                <option value="0">无</option>
                {$tree_list}
            </select>
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">标题：</label>
        <div class="col-xs-12 col-sm-8">
            <input data-rule="required" class="form-control" name="row[title]" type="text" value="{$row.title}">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">文章缩略图：</label>
        <div class="col-xs-12 col-sm-8 ">
            <input type="file" class="file" id="upload-pic" name="upload" accept="image/*">
            <input type="hidden" id="h-pic" name="row[pic]" value="{$row.pic}" data-rule="required">
        </div>
        <div id="errorBlock" class="help-block"></div>
    </div> 

    <div class="form-group">
        <label for="c-remark" class="control-label col-xs-12 col-sm-2">文章内容：</label>
        <div class="col-xs-12 col-sm-8">
            <textarea id="ck_editor" class="form-control" name="row[content]" rows="10" cols="80">{$row.content}</textarea>
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">SEO标题：</label>
        <div class="col-xs-12 col-sm-8">
            <input class="form-control" name="row[seo_title]" type="text" value="{$row.seo_title}">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">SEO关键词：</label>
        <div class="col-xs-12 col-sm-8">
            <input class="form-control" name="row[seo_keyword]" type="text" value="{$row.seo_keyword}">
        </div>
    </div>
    <div class="form-group">
        <label for="c-remark" class="control-label col-xs-12 col-sm-2">SEO描述：</label>
        <div class="col-xs-12 col-sm-8">
            <textarea class="form-control" name="row[seo_description]">{$row.seo_description}</textarea>
        </div>
    </div>
    <div class="form-group">
        <label for="c-weigh" class="control-label col-xs-12 col-sm-2">权重：</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-weigh" data-rule="required" class="form-control" name="row[weigh]" type="text" value="{$row.weigh}">
        </div>
    </div>
    <div class="form-group">
        <label for="c-status" class="control-label col-xs-12 col-sm-2">状态：</label>
        <div class="col-xs-12 col-sm-8">
            <div class="radio">
                <label for="row[status]-1"><input id="row[status]-1" {eq name="row['status']" value="1"}checked="checked"{/eq} name="row[status]" type="radio" value="1"> 正常</label> 
                <label for="row[status]-0"><input id="row[status]-0" {eq name="row['status']" value="0"}checked="checked"{/eq} name="row[status]" type="radio" value="0"> 禁止</label>
            </div>        
        </div>
    </div>
    <div class="form-group layer-footer">
        <label class="control-label col-xs-12 col-sm-2"></label>
        <div class="col-xs-12 col-sm-8">
            <button type="submit" class="btn btn-success btn-embossed" id="btn_submit">确认</button>
            <button type="reset" class="btn btn-default btn-embossed">重置</button>
        </div>
    </div>
</form>

<!-- ckeditor.js -->
<script src="__STATIC__/libs/ckeditor/ckeditor.js"></script>
<!-- bootstrap-wysihtml5 -->
<script src="__STATIC__/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
<!-- fileinput -->
<script src="__STATIC__/libs/bootstrap-fileinput/js/fileinput.min.js"></script>
<script src="__STATIC__/libs/bootstrap-fileinput/js/plugins/sortable.min.js"></script>
<script src="__STATIC__/libs/bootstrap-fileinput/js/locales/zh.js"></script>

<script>
    //编辑器
    $(function () {
        CKEDITOR.replace('ck_editor', {   
            height: 350,   
            filebrowserUploadUrl: "/admin/ajax/ckUpload", //设置图片上传请求地址  
        });

        function getContenet(){
            return CKEDITOR.instances.ck_editor.getData();    //获取textarea的值
        }

        $("#btn_submit").click(function () {
            $("#ck_editor").val(getContenet());
        });
    });

    var url1 = '{$row.pic}';

    $("#upload-pic").fileinput({
        language: "zh",
        enctype:'multipart/form-data',
        uploadUrl: "/admin/ajax/fileInputUpload",
        overwriteInitial: false,
        required: true,
        maxFilesNum:1, //表示允许同时上传的最大文件个数
        allowedFileExtensions: ["jpg", "png", "gif"],
        showUpload: false, //是否显示上传按钮
        deleteUrl: "/admin/ajax/picdel",
        maxFileSize:2097152,
        initialPreview: [url1],
        initialPreviewAsData: true,
        initialPreviewConfig: [{key: 1}],
        layoutTemplates :{
            actionDelete:'', //去除上传预览的缩略图中的删除图标
            //actionUpload:'',//去除上传预览缩略图中的上传图片；
            //actionZoom:''   //去除上传预览缩略图中的查看详情预览的缩略图标。
        },

        //showPreview: false,
        // uploadExtraData:{"id": 1, "fileName":'123.mp3'},
        // uploadAsync: true, //默认异步上传
        // showRemove :true, //显示移除按钮
        // showPreview :true, //是否显示预览
        // showCaption:false,//是否显示标题
        // browseClass:"btn btn-primary", //按钮样式    
        // dropZoneEnabled: false,//是否显示拖拽区域
        // minImageWidth: 50, //图片的最小宽度
        // minImageHeight: 50,//图片的最小高度
        // maxImageWidth: 1000,//图片的最大宽度
        // maxImageHeight: 1000,//图片的最大高度
        // maxFileSize:0,//单位为kb，如果为0表示不限制文件大小
        // minFileCount: 0,
        // maxFileCount:10, //表示允许同时上传的最大文件个数
        // validateInitialCount:true,
        // previewFileIcon: "<iclass='glyphicon glyphicon-king'></i>",
        // msgFilesTooMany: "选择上传的文件数量({n}) 超过允许的最大数值{m}！",
    }).on("filebatchselected", function(event, files) {
        $("#upload-pic").fileinput("upload");
    }).on("fileuploaded", function (event, data, previewId, index){
        $('#h-pic').val(data.response.pic_url);       
    }); 

</script>